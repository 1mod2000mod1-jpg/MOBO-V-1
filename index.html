<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <title id="site-title">Cold Room - Chat</title>
    <meta name="description" content="Cold Room - Premium Chat Platform">
    
    <link rel="icon" type="image/x-icon" id="site-favicon" href="https://i.ibb.co/ZYW3VTp/cold-room-logo.png">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    
    <!-- الخلفيات المتحركة -->
    <div class="snowflakes" id="snowflakes"></div>
    <canvas id="snowman-canvas"></canvas>
    
    <!-- موسيقى الخلفية -->
    <audio id="background-music" loop></audio>

    <!-- شاشة تسجيل الدخول -->
    <div id="login-screen" class="screen active">
        <div class="login-container">
            
            <!-- الشعار -->
            <div class="site-logo">
                <img src="https://i.ibb.co/ZYW3VTp/cold-room-logo.png" 
                     alt="Cold Room" 
                     class="logo-image"
                     id="main-logo">
                <div class="logo-text" id="main-title">Cold Room</div>
                <p class="logo-subtitle">Premium Chat Experience</p>
            </div>
            
            <div class="login-options">
                <!-- تسجيل الدخول -->
                <div class="glass-card">
                    <h3>🔐 Login</h3>
                    <div class="input-group">
                        <input type="text" id="login-username" placeholder="Username" 
                               maxlength="20" class="modern-input" autocomplete="username">
                        <input type="password" id="login-password" placeholder="Password" 
                               maxlength="100" class="modern-input" autocomplete="current-password">
                    </div>
                    <button class="modern-btn" onclick="login()">
                        <span class="btn-text">Enter Chat</span>
                    </button>
                </div>
                
                <!-- إنشاء حساب -->
                <div class="glass-card">
                    <h3>✨ Create Account</h3>
                    <div class="input-group">
                        <input type="text" id="register-username" placeholder="Username (3-20 chars)" 
                               maxlength="20" class="modern-input" autocomplete="username">
                        <input type="password" id="register-password" placeholder="Password (6+ chars)" 
                               maxlength="100" class="modern-input" autocomplete="new-password">
                        <input type="text" id="register-displayname" placeholder="Display Name" 
                               maxlength="30" class="modern-input">
                    </div>
                    <button class="modern-btn" onclick="register()">
                        <span class="btn-text">Create Account</span>
                    </button>
                </div>
            </div>

            <!-- رسالة للمدير -->
            <div class="glass-card support-section" id="support-section" style="display: none;">
                <h4>📩 Support Message</h4>
                <p style="margin-bottom: 1rem; opacity: 0.9;">
                    Send appeal to owner
                </p>
                <textarea id="support-message" class="modern-input" 
                          placeholder="Write your message..." 
                          maxlength="500" rows="4"></textarea>
                <button class="modern-btn" onclick="sendSupportMessage()">
                    Send to Owner
                </button>
            </div>

            <!-- حقوق النشر -->
            <div class="copyright-notice">
                <strong>© 2025 Cold Room</strong><br>
                Owner: Cold Room King<br>
                <small>All rights reserved</small>
            </div>
        </div>
    </div>

    <!-- شاشة الدردشة -->
    <div id="chat-screen" class="screen">
        <div class="chat-container">
            
            <!-- الهيدر -->
            <header class="chat-header">
                <div class="header-left">
                    <div class="header-logo">
                        <img src="https://i.ibb.co/ZYW3VTp/cold-room-logo.png" 
                             alt="Cold Room" 
                             class="header-logo-image"
                             id="header-logo">
                        <div>
                            <h1 id="header-title">Cold Room</h1>
                            <div class="room-info" id="room-info">❄️ Global Room</div>
                        </div>
                    </div>
                    <div class="user-status">
                        <span class="current-user-avatar" id="current-user-avatar"></span>
                        <span id="current-user-name"></span>
                        <span id="user-badges"></span>
                    </div>
                </div>
                <div class="header-right">
                    <button class="modern-btn small" id="owner-panel-btn" 
                            style="display: none;" onclick="showOwnerPanel()">
                        👑 Owner Panel
                    </button>
                    <button class="modern-btn small" onclick="toggleRoomsList()">
                        🏠 Rooms
                    </button>
                    <button class="modern-btn small" onclick="toggleUsersList()">
                        👥 Users
                    </button>
                    <button class="modern-btn small" onclick="showPrivateMessages()">
                        💬 Private
                    </button>
                    <button class="modern-btn small" onclick="logout()">
                        🚪 Logout
                    </button>
                </div>
            </header>
            
            <!-- المنطقة الرئيسية -->
            <div class="chat-main">
                
                <!-- قائمة الغرف -->
                <div id="rooms-sidebar" class="sidebar rooms-sidebar">
                    <div class="sidebar-header">
                        <h3>🏠 Rooms</h3>
                        <button class="modern-btn small" onclick="showCreateRoomModal()">
                            ➕ New
                        </button>
                    </div>
                    <div id="rooms-list" class="rooms-list"></div>
                </div>

                <!-- قائمة المستخدمين -->
                <div id="users-sidebar" class="sidebar users-sidebar">
                    <div class="sidebar-header">
                        <h3>👥 Online (<span id="users-count">0</span>)</h3>
                        <button class="modern-btn small" onclick="toggleUsersList()">✕</button>
                    </div>
                    <div id="users-list" class="users-list"></div>
                </div>
                
                <!-- منطقة الرسائل -->
                <div class="chat-content">
                    <div class="chat-messages" id="messages">
                        <div class="welcome-message glass-card">
                            <img src="https://i.ibb.co/ZYW3VTp/cold-room-logo.png" 
                                 alt="Welcome" class="welcome-logo">
                            <h3>Welcome to Cold Room! ❄️</h3>
                            <p>Start chatting with others</p>
                        </div>
                    </div>
                    
                    <!-- أدوات الإرسال -->
                    <div class="chat-tools">
                        <form id="message-form" class="message-form">
                            <textarea id="message-input" class="message-input" 
                                    placeholder="Type your message... (500 chars max)" 
                                    maxlength="500" rows="1" disabled></textarea>
                            <button type="submit" class="modern-btn" disabled>
                                Send 🚀
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة إنشاء غرفة -->
    <div id="create-room-modal" class="modal">
        <div class="modal-content glass-card">
            <span class="modal-close" onclick="hideModal('create-room-modal')">&times;</span>
            <h2>🏠 Create New Room</h2>
            <div class="modal-body">
                <input type="text" id="room-name-input" class="modern-input" 
                       placeholder="Room Name" maxlength="50">
                <textarea id="room-desc-input" class="modern-input" 
                          placeholder="Description (optional)" maxlength="200" rows="3"></textarea>
                <input type="password" id="room-pass-input" class="modern-input" 
                       placeholder="Password (optional)" maxlength="50">
                <button class="modern-btn" onclick="createRoom()">
                    Create Room
                </button>
            </div>
        </div>
    </div>

    <!-- نافذة الرسائل الخاصة -->
    <div id="private-messages-modal" class="modal">
        <div class="modal-content glass-card large-modal">
            <span class="modal-close" onclick="hideModal('private-messages-modal')">&times;</span>
            <h2>💬 Private Messages</h2>
            <div class="modal-body private-chat">
                <div class="private-users-list" id="private-users-list"></div>
                <div class="private-messages-area">
                    <div class="private-messages" id="private-messages"></div>
                    <div class="private-input-area">
                        <textarea id="private-message-input" class="modern-input" 
                                  placeholder="Type message..." maxlength="500" rows="2"></textarea>
                        <button class="modern-btn" onclick="sendPrivateMessage()">
                            Send
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة لوحة المالك -->
    <div id="owner-panel-modal" class="modal">
        <div class="modal-content glass-card owner-modal">
            <span class="modal-close" onclick="hideModal('owner-panel-modal')">&times;</span>
            <h2>👑 Owner Control Panel</h2>
            <div class="modal-body">
                <div class="owner-tabs">
                    <button class="tab-btn active" onclick="switchOwnerTab('muted')">
                        🔇 Muted
                    </button>
                    <button class="tab-btn" onclick="switchOwnerTab('banned')">
                        🚫 Banned
                    </button>
                    <button class="tab-btn" onclick="switchOwnerTab('support')">
                        📩 Support
                    </button>
                    <button class="tab-btn" onclick="switchOwnerTab('settings')">
                        ⚙️ Settings
                    </button>
                </div>

                <div class="owner-content">
                    <!-- المكتومين -->
                    <div id="owner-muted" class="owner-tab-content active">
                        <div id="muted-list" class="owner-list"></div>
                    </div>

                    <!-- المحظورين -->
                    <div id="owner-banned" class="owner-tab-content">
                        <div id="banned-list" class="owner-list"></div>
                    </div>

                    <!-- رسائل الدعم -->
                    <div id="owner-support" class="owner-tab-content">
                        <div id="support-messages-list" class="owner-list"></div>
                    </div>

                    <!-- الإعدادات -->
                    <div id="owner-settings" class="owner-tab-content">
                        <div class="settings-grid">
                            <div class="setting-item">
                                <label>Site Logo URL:</label>
                                <input type="text" id="setting-logo" class="modern-input" 
                                       placeholder="https://...">
                                <button class="modern-btn small" onclick="updateLogo()">Update</button>
                            </div>
                            <div class="setting-item">
                                <label>Site Title:</label>
                                <input type="text" id="setting-title" class="modern-input" 
                                       placeholder="Cold Room">
                                <button class="modern-btn small" onclick="updateTitle()">Update</button>
                            </div>
                            <div class="setting-item">
                                <label>Background Music URL (MP3):</label>
                                <input type="text" id="setting-music" class="modern-input" 
                                       placeholder="https://...music.mp3">
                                <button class="modern-btn small" onclick="updateMusic()">Update</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- قائمة الإجراءات -->
    <div id="message-actions-menu" class="actions-menu glass-card" style="display: none;">
        <div class="actions-menu-header">⚙️ Actions</div>
        <div id="message-actions-list"></div>
    </div>

    <!-- السكريبتات -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html>
